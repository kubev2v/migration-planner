// Package v1alpha1 provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.3.0 DO NOT EDIT.
package v1alpha1

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"

	"github.com/getkin/kin-openapi/openapi3"
	externalRef0 "github.com/kubev2v/migration-planner/api/v1alpha1"
)

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"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",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	pathPrefix := path.Dir(pathToFile)

	for rawPath, rawFunc := range externalRef0.PathToRawSpec(path.Join(pathPrefix, "../openapi.yaml")) {
		if _, ok := res[rawPath]; ok {
			// it is not possible to compare functions in golang, so always overwrite the old value
		}
		res[rawPath] = rawFunc
	}
	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}

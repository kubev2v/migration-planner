// Package v1alpha1 provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.3.0 DO NOT EDIT.
package v1alpha1

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"

	"github.com/getkin/kin-openapi/openapi3"
	externalRef0 "github.com/kubev2v/migration-planner/api/v1alpha1"
)

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"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",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	pathPrefix := path.Dir(pathToFile)

	for rawPath, rawFunc := range externalRef0.PathToRawSpec(path.Join(pathPrefix, "../openapi.yaml")) {
		if _, ok := res[rawPath]; ok {
			// it is not possible to compare functions in golang, so always overwrite the old value
		}
		res[rawPath] = rawFunc
	}
	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}

// Package v1alpha1 provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.3.0 DO NOT EDIT.
package v1alpha1

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"

	"github.com/getkin/kin-openapi/openapi3"
	externalRef0 "github.com/kubev2v/migration-planner/api/v1alpha1"
)

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"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",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	pathPrefix := path.Dir(pathToFile)

	for rawPath, rawFunc := range externalRef0.PathToRawSpec(path.Join(pathPrefix, "../openapi.yaml")) {
		if _, ok := res[rawPath]; ok {
			// it is not possible to compare functions in golang, so always overwrite the old value
		}
		res[rawPath] = rawFunc
	}
	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}

{{- /*
Network Query Template - Extracts network data from dvSwitch and dvPort tables.

Matches old implementation which adds:
1. All switches from dvSwitch sheet (type "dvswitch")
2. All ports from dvPort sheet (type "distributed")

VM counts are populated separately by inventory_builder using VMCountByNetwork.

Template Parameters:
  - ClusterFilter: filter by cluster name (not used - networks are global)
  - Limit: max results (0 = unlimited)
  - Offset: skip first N results
*/ -}}
SELECT
    '' as "cluster",
    '' as "dvswitch",
    "Name" as "name",
    'dvswitch' as "type",
    '' as "vlanId"
FROM dvswitch
WHERE "Name" IS NOT NULL AND "Name" != ''
UNION ALL
SELECT
    '' as "cluster",
    COALESCE("Switch", '') as "dvswitch",
    "Port" as "name",
    'distributed' as "type",
    COALESCE("VLAN", '') as "vlanId"
FROM dvport
WHERE "Port" IS NOT NULL AND "Port" != ''
{{- if and .Limit (gt .Limit 0) }} LIMIT {{.Limit}}{{end}}
{{- if and .Offset (gt .Offset 0) }} OFFSET {{.Offset}}{{end}};

{{- /*
Clusters Query Template - Returns distinct cluster names ordered by VM count (biggest to smallest).
*/ -}}
SELECT "Cluster"
FROM (
    SELECT "Cluster", COUNT(*) as vm_count
    FROM vinfo
    WHERE "Cluster" IS NOT NULL AND "Cluster" != ''
    GROUP BY "Cluster"
)
ORDER BY vm_count DESC, "Cluster";

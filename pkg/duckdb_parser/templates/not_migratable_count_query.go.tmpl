{{- /*
Not Migratable Count Query Template - Returns count of VMs with Critical concerns.

Template Parameters:
  - ClusterFilter: filter by cluster name
*/ -}}
SELECT COUNT(DISTINCT i."VM ID")
FROM vinfo i
JOIN concerns c ON i."VM ID" = c."VM_ID" AND c."Category" = 'Critical'
WHERE 1=1
{{- if .ClusterFilter }} AND i."Cluster" = '{{.ClusterFilter}}'{{end}};
